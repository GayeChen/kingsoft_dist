webpackJsonp([42],{78:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var a=n(263),o=r(a),i=n(262),u=r(i);t.default=function(){function e(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=(0,u.default)(e);!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(a)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},179:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.getRuleSampleList=t.deleteRule=t.getUserOPAuthority=t.monitorImage=t.hostIndividual=t.hostShow=t.getrecharts=t.getRules=t.updateScreen=t.getScreen=t.getScreenGraph=t.getScreenCards=t.createScreenCard=t.getNodeHosts=t.updatePlugin=t.createPlugin=t.updateRule=t.testRule=t.createRule=t.getAllGroup=t.getExpression=t.getPlugin=t.freshPlugins=t.getRule=t.freshRules=t.getChart=t.createChart=t.getMetrics=t.getInstance=t.getHostMonitoringBatch=t.getHostMonitoringList=t.getMachines=t.getNonRecoveryList=t.getErrNum=t.getStatistics=void 0;var a=n(78),o=r(a),i=n(236),u=r(i),c=n(204),s=n(49),l="/apm",d=(t.getStatistics=function(e){return(0,c.clientSender)(l+"/dashboard/"+e+"/statistics",{},"POST",!0).then(function(e){return e.data?e.data.statistics:void(e.msg&&s.notices.error(e.msg))})},t.getErrNum=function(e,t){var n={org_id:e};return t&&(n.node_id=t),(0,c.get)("/uprober/url/statics",n).then(function(e){return e?{total:e.total,errNum:e.errNum}:void(e.msg&&s.notices.error(e.msg))})},t.getNonRecoveryList=function(e){return(0,c.clientSender)(l+"/alarm/"+e+"/nonrecovery/list",{},"POST",!0).then(function(e){return e.data?e.data.nonrecoveryalarms:void(e.msg&&s.notices.error(e.msg))})},t.getMachines=function(e){return(0,c.clientSender)(l+"/host/"+e+"/list",{},"GET").then(function(e){return e||u.default.reject(),e.data?e.data.hosts:void(e.msg&&s.notices.error(e.msg))})}),f=(t.getHostMonitoringList=function(e){return(0,c.clientSender)(l+"/host/"+e+"/info/list",{},"GET").then(function(e){return e||u.default.reject(),e.data?e.data.hosts:void(e.msg&&s.notices.error(e.msg))})},t.getHostMonitoringBatch=function(e,t){var n=t&&t.length?"endpoints="+t+"&":"";return(0,c.clientSender)(l+"/stats/"+e+"/metric/list?"+n+"limit=1000",{},"POST").then(function(e){return e||u.default.reject(),e.data?e.data.counters:void(e.msg&&s.notices.error(e.msg))})},t.getInstance=d,t.getMetrics=function(e,t){var n=t&&t.length?"endpoints="+t+"&":"";return(0,c.clientSender)(l+"/stats/"+e+"/metric/list?"+n+"limit=1000",{},"POST",!0).then(function(e){return e.data?e.data.counters.map(function(e,t){var n=/(.*?)\/(.*)/.exec(e),r=(0,o.default)(n,3),a=r[1],i=r[2];return{id:1+t,name:a,tag:i,options:e}}):e.msg?[]:void 0})},t.createChart=function(e){var t=e.id,n=e.title,r=e.endpoints,a=e.counters;return(0,c.clientSender)(l+"/chart/"+t+"/create",[{title:n,endpoints:r,counters:a}],"POST",!0).then(function(e){return e.data?e.data[0]:void(e.msg&&s.notices.error(e.msg))})},t.getChart=function(e,t){return(0,c.clientSender)(l+"/chart/"+e+"/"+t+"/json?style=small",{},"POST",!0).then(function(e){return e.data?e.data:void(e.msg&&s.notices.error(e.msg))})},function(e){return e.Rule.nodePath=e.NodePath,e.Rule.endpointsInfo=e.EndpointsInfo,e.Rule.teamIds=e.TeamIds?e.TeamIds.split(","):[],e.Rule.desc=e.Desc,e.Rule.upgrade1Interval=e.Upgrade1Interval,e.Rule.upgrade1TeamIds=e.Upgrade1TeamIds?e.Upgrade1TeamIds.split(","):[],e.Rule.upgrade2Interval=e.Upgrade2Interval,e.Rule.upgrade2TeamIds=e.Upgrade2TeamIds?e.Upgrade2TeamIds.split(","):[],e.Rule}),m=(t.freshRules=function(e){return(0,c.clientSender)(l+"/rule/"+e+"/list",{},"POST",!0).then(function(e){return e.data?e.data.map(f):void(e.msg&&s.notices.error(e.msg))})},t.getRule=function(e,t){return(0,c.clientSender)(l+"/rule/"+e+"/"+t+"/json",{},"POST",!0).then(function(e){return e.data?f(e.data):void(e.msg&&s.notices.error(e.msg))})},t.freshPlugins=function(e){return(0,c.clientSender)(l+"/plugin/"+e+"/list",{},"POST",!0).then(function(e){return e.data&&e.data.plugins?e.data.plugins:void(e.msg&&s.notices.error(e.msg))})},t.getPlugin=function(e,t){return(0,c.clientSender)(l+"/plugin/"+e+"/"+t+"/json",{},"POST",!0).then(function(e){return e.data&&e.data.plugins?e.data.plugins[0]:void(e.msg&&s.notices.error(e.msg))})},t.getExpression=function(e){var t=e.count,n=e.calc,r=e.op,a=e.rightValue;return(0,c.clientSender)(l+"/rule/expression/check?count="+t+"&calc="+n+"&op="+r+"&right_value="+a,{},"POST",!0).then(function(e){return e.data?e.data:void(e.msg&&!/(cannot\sfind\sany\sgroup)$/.test(e.msg)&&s.notices.error(e.msg))})},t.getAllGroup=function(e){return(0,c.clientSender)(l+"/groups/"+e+"/list",{},"POST",!0).then(function(e){return e.data?e.data.groups:void(e.msg&&!/(cannot\sfind\sany\sgroup)$/.test(e.msg)&&s.notices.error(e.msg))})},t.createRule=function(e,t){var n=m(t),r=n.queryString,a=n.body;return(0,c.clientSender)(l+"/rule/"+e+"/create"+r,a,"POST",!0).then(function(e){if(e.msg?s.notices.error(e.msg):s.notices.success("创建成功"),e.data)return e.data.ruleid})},t.testRule=function(e,t){var n=m(t),r=n.queryString,a=n.body;return(0,c.clientSender)(l+"/rule/"+e+"/trigger"+r,a,"POST",!0).then(function(e){return e.msg?(s.notices.error(e.msg),u.default.reject()):e.data?e.data.MatchedMetrics:void 0})},t.updateRule=function(e,t,n){var r=m(n),a=r.queryString,o=r.body;return(0,c.clientSender)(l+"/rule/"+e+"/"+t+"/update"+a,o,"POST",!0).then(function(e){return e.msg?(s.notices.error(e.msg),u.default.reject()):(s.notices.success("修改成功"),e.data?e.data.ruleid:void 0)})},function(e){var t={team_ids:e.team_ids,upgrade1_interval:e.upgrade1_interval,upgrade1_team_ids:e.upgrade1_team_ids,upgrade2_interval:e.upgrade2_interval,upgrade2_team_ids:e.upgrade2_team_ids},n=p(t);for(var r in t)delete e[r];return{queryString:n,body:e}}),p=(t.createPlugin=function(e,t){return t.node_id=e,(0,c.clientSender)(l+"/plugin/"+e+"/bind?p=mysql",t,"POST",!0).then(function(e){return e.data?e.data.bindid:void(e.msg&&s.notices.error(e.msg))})},t.updatePlugin=function(e,t,n){return(0,c.clientSender)(l+"/plugin/"+e+"/"+t+"/update?p=mysql",n,"POST",!0).then(function(e){return e.msg?(s.notices.error(e.msg),u.default.reject()):e.data?e.data.bindid:void 0})},function(e){var t=[];for(var n in e){var r=e[n];void 0!=r&&null!=r&&""!=r&&(r instanceof Array&&0==r.length||t.push(n+"="+r))}return"?"+t.join("&")});t.getNodeHosts=function(e){return(0,c.clientSender)(l+"/tree/"+e+"/list",{},"POST",!0).then(function(e){return e&&e.data?e.data.tree.map(function(e){var t=(0,o.default)(e,2),n=t[0],r=t[1];return{id:n,path:r}}):void(e.msg&&s.notices.error(e.msg))})},t.createScreenCard=function(e,t){return(0,c.clientSender)(l+"/screen/"+e+"/card/create",t,"POST",!0).then(function(e){return e.data?e.data.card:void(e.msg&&s.notices.error(e.msg))})},t.getScreenCards=function(e){return(0,c.clientSender)(l+"/screen/"+e+"/card/list",{},"POST",!0).then(function(e){return e.data?e.data.cards:void(e.msg&&s.notices.error(e.msg))})},t.getScreenGraph=function(e,t){return(0,c.clientSender)(l+"/screen/"+e+"/cardgraph/"+t+"/json",{},"POST",!0).then(function(e){return e.data?e.data:void(e.msg&&s.notices.error(e.msg))})},t.getScreen=function(e,t){return(0,c.clientSender)(l+"/screen/"+e+"/card/"+t+"/json",{},"POST",!0).then(function(e){return e.data?e.data.card:void(e.msg&&s.notices.error(e.msg))})},t.updateScreen=function(e,t,n){return(0,c.clientSender)(l+"/screen/"+e+"/card/"+t+"/update",n,"POST",!0).then(function(e){return e.data?e.data.card:void(e.msg&&s.notices.error(e.msg))})},t.getRules=function(e,t){return(0,c.clientSender)(l+"/rule/"+e+"/list?p="+t,{},"POST",!0).then(function(e){return e?e.data?e.data.map(f):void(e.msg&&s.notices.error(e.msg)):u.default.reject()})},t.getrecharts=function(e,t,n){var r="/apm/chart/"+e+"/counter/json?startts=-600&endts=0&rra=AVERAGE&style=small&counter="+t+"&endpoints="+n+"&sum=0&nodeid="+e;return(0,c.clientSender)(r,{},"POST").then(function(e){return e?{res:e}:void(e.msg&&s.notices.error(e.msg))})},t.hostShow=function(e,t){return(0,c.get)("/cloud/tree/"+e+"/host",{scol:"host.id",search:t}).then(function(e){return e?{res:e}:void(e.msg&&s.notices.error(e.msg))})},t.hostIndividual=function(e,t){return(0,c.get)("/apm/host/"+e+"/info/mon/json",{endpoint:t}).then(function(e){return e?{res:e}:void(e.msg&&s.notices.error(e.msg))})},t.monitorImage=function(e,t){var n="/apm/chart/"+e+"/counter/json?startts=-600&endts=0&rra=AVERAGE&style=small&counter=mem.swapused.percent&endpoints="+t+"&sum=0&nodeid="+e;return(0,c.clientSender)(n,{},"POST").then(function(e){return e?{res:e}:void(e.msg&&s.notices.error(e.msg))})},t.getUserOPAuthority=function(e,t,n){return(0,c.clientSender)("/authority/user/"+e+"/node/"+t+"/has/"+n,{},"GET").then(function(e){return e||u.default.reject(),e.data?e.data:void(e.msg&&s.notices.error(e.msg))})},t.deleteRule=function(e,t){return(0,c.clientSender)(l+"/rule/"+e+"/"+t+"/delete",{},"POST",!0)},t.getRuleSampleList=function(e){return(0,c.clientSender)(l+"/rule/"+e+"/sample/list",{},"POST",!0).then(function(e){return e?e.data?e.data.map(f):void(e.msg&&s.notices.error(e.msg)):u.default.reject()})}},262:function(e,t,n){e.exports={default:n(264),__esModule:!0}},263:function(e,t,n){e.exports={default:n(265),__esModule:!0}},264:function(e,t,n){n(246),n(241),e.exports=n(267)},265:function(e,t,n){n(246),n(241),e.exports=n(268)},267:function(e,t,n){var r=n(304),a=n(342);e.exports=n(116).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},268:function(e,t,n){var r=n(335),a=n(266)("iterator"),o=n(326);e.exports=n(116).isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||o.hasOwnProperty(r(t))}},417:function(e,t,n){"use strict";function r(e){}var a=function(e){return void 0!==e&&null!==e},o=/[\[\]\.]+/,i=function(e,t,n){if(!a(e))return{};var r=Array.isArray(t)?t:t.split(o),i=null,u=e,c=[],s=!0,l=!1,d=void 0;try{for(var f,m=r[Symbol.iterator]();!(s=(f=m.next()).done);s=!0){var p=f.value;if(0!==p.length&&(i=u,u=u[p],c.push(p),!a(u))){if(!n)return{path:c};i[p]={},u=i[p]}}}catch(e){l=!0,d=e}finally{try{!s&&m.return&&m.return()}finally{if(l)throw d}}return{value:u,path:c}},u=function(e,t){return r("`exist()` is deprecated, please use `exist.detect()`."),a(i(e,t).value)};u.detect=function(e,t){var n=i(e,t);return!!a(n.value)||n.path},u.get=function(e,t,n){var r=i(e,t).value;return a(r)?r:n},u.set=function(e,t,n,r){var u=Array.isArray(t)?t:t.split(o),c=u.pop(),s=i(e,u,r).value;return!!a(s)&&(s[c]=n,!0)};var c=function(){};u.invoke=function(e,t){var n=Array.isArray(t)?t:t.split(o),r=n.pop(),u=i(e,n).value;if(a(u)){var s=u[r];if("function"==typeof s)return s.bind(u)}return c},e.exports=u},1677:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(78),o=r(a),i=n(11),u=r(i),c=n(3),s=r(c),l=n(7),d=r(l),f=n(5),m=r(f),p=n(4),g=r(p),v=n(1),h=r(v),y=n(200),S=n(179),P=function(e){function t(){var e;(0,s.default)(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=(0,m.default)(this,(e=t.__proto__||(0,u.default)(t)).call.apply(e,[this].concat(r)));return o.state={nonRecoveryAlarms:[]},o}return(0,g.default)(t,e),(0,d.default)(t,[{key:"componentWillReceiveProps",value:function(e){e.nodeId!=this.props.nodeId&&this.fetch(e.nodeId)}},{key:"componentWillMount",value:function(){this.fetch(this.props.nodeId)}},{key:"fetch",value:function(e){var t=this;(0,S.getNonRecoveryList)(e).then(function(e){var n=_.filter(e,function(e){return 0===e.priority}).length,r=_.filter(e,function(e){return 1===e.priority}).length,a=_.filter(e,function(e){return 2===e.priority}).length,o=e&&e.length?e.length:0;t.setState({nonRecoveryAlarms:[n,r,a,o]})})}},{key:"render",value:function(){var e=(0,o.default)(this.state.nonRecoveryAlarms,4),t=e[0],n=e[1],r=e[2],a=(e[3],this.props.nodeId);return h.default.createElement("div",{className:"norecovery-alarms-container module-container"},h.default.createElement("div",{className:"norecovery-alarms-title"},"未恢复的告警"),h.default.createElement("div",{className:"alarm-block-container"},h.default.createElement(y.Link,{className:"alarm-item-container",to:"/center/tree/"+a+"/monitor/events"},h.default.createElement("span",null,"严重故障信息"),h.default.createElement("span",{className:"alarm-num"},t||0)),h.default.createElement(y.Link,{className:"alarm-item-container second",to:"/center/tree/"+a+"/monitor/events"},h.default.createElement("span",null,"轻微故障信息"),h.default.createElement("span",{className:"alarm-num"},n||0)),h.default.createElement(y.Link,{className:"alarm-item-container third",to:"/center/tree/"+a+"/monitor/events"},h.default.createElement("span",null,"预警信息数量"),h.default.createElement("span",{className:"alarm-num"},r||0))))}}]),t}(h.default.Component);t.default=P},1678:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(11),o=r(a),i=n(3),u=r(i),c=n(7),s=r(c),l=n(5),d=r(l),f=n(4),m=r(f),p=n(1),g=r(p),v=n(427),h=r(v),y=function(e){function t(){var e,n,r,a;(0,u.default)(this,t);for(var i=arguments.length,c=Array(i),s=0;s<i;s++)c[s]=arguments[s];return n=r=(0,d.default)(this,(e=t.__proto__||(0,o.default)(t)).call.apply(e,[this].concat(c))),r.getPieData=function(e,t){var n=[{value:t,name:"异常主机"},{value:e,name:"正常主机"}];return n=n.filter(function(e){return!!e.value}),n.length||(n=[{value:0,name:"异常主机"},{value:0,name:"正常主机"}]),n},r.initChart=function(e){var t=e||r.props,n=t.hostsNormal,a=t.hostsAbnormal;r.myPieChart=h.default.init(r.pie);var o={color:["#FF495F","#31E5D3"],backgroundColor:"#2C3B40",tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{data:[{name:"正常主机",icon:"circle",textStyle:{color:"#31E5D3"}},{name:"异常主机",icon:"circle",textStyle:{color:"#c23531"}}],textStyle:{color:"#fff"},bottom:"30px",right:"50px"},calculable:!0,series:[{name:"监控上报主机数",type:"pie",radius:[40,80],center:["50%","40%"],roseType:"area",data:r.getPieData(n,a)}]};r.myPieChart.setOption(o)},a=n,(0,d.default)(r,a)}return(0,m.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){this.initChart()}},{key:"componentWillReceiveProps",value:function(e){this.props.hostsNormal===e.hostsNormal&&this.props.hostsAbnormal===e.hostsAbnormal||this.initChart(e)}},{key:"render",value:function(){var e=this;return g.default.createElement("div",{ref:function(t){return e.pie=t},className:"overview-pie module-container"})}}]),t}(p.Component);t.default=y},1679:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,o,i,u,c=n(11),s=r(c),l=n(3),d=r(l),f=n(7),m=r(f),p=n(5),g=r(p),v=n(4),h=r(v),y=n(1),S=r(y),_=n(1677),P=r(_),b=n(1678),x=r(b),N=n(179),T=n(37),E=n(417),O=r(E);n(2975);var w=function(e){return{orgId:O.default.get(e,"home.curOrg.org_id")}},I=(a=(0,T.connect)(w,null),a((u=i=function(e){function t(){var e;(0,d.default)(this,t);for(var n=arguments.length,r=Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=(0,g.default)(this,(e=t.__proto__||(0,s.default)(t)).call.apply(e,[this].concat(r)));return o.fetch=function(e){var t=e||o.props,n=t.params.nodeId;t.orgId;(0,N.getStatistics)(n).then(function(e){o.setState({ActiveHostNum:e.ActiveHostNum||0,NonActiveHostNum:e.NonActiveHostNum||0})})},o.state={HostNum:0,ActiveHostNum:0,NonActiveHostNum:0},o}return(0,h.default)(t,e),(0,m.default)(t,[{key:"componentWillReceiveProps",value:function(e){e.params.nodeId&&e.params.nodeId!=this.props.params.nodeId&&this.fetch(e)}},{key:"componentWillMount",value:function(){this.fetch()}},{key:"render",value:function(){var e=this.props.params.nodeId,t=this.state,n=t.ActiveHostNum,r=t.NonActiveHostNum;t.HostNum;return S.default.createElement("div",{className:"overview-container"},S.default.createElement("div",{className:"overview-title"},"概览"),S.default.createElement(P.default,{nodeId:e}),S.default.createElement("div",{className:"module-container"},S.default.createElement("div",{className:"pie-header"},S.default.createElement("span",null,"监控上报异常主机数",S.default.createElement("span",{className:"pie-abnormal-num num"},r)),S.default.createElement("span",null,"主机总数",S.default.createElement("span",{className:"pie-total-num num"},n+r))),S.default.createElement(x.default,{hostsNormal:n,hostsAbnormal:r})))}}]),t}(y.Component),i.contextTypes={router:S.default.PropTypes.object.isRequired},o=u))||o);t.default=I},2118:function(e,t,n){t=e.exports=n(31)(),t.push([e.id,".overview-container{background:#283138;min-height:calc(100vh - 74px);padding:20px;overflow:hidden}.overview-container .overview-title{font-size:24px;color:#fff;line-height:24px;margin-bottom:18px}.overview-container .norecovery-alarms-container{width:887px;height:221px;padding:20px}.overview-container .alarm-block-container{display:flex;margin-top:30px}.overview-container .alarm-block-container .alarm-item-container{width:260px;height:90px;line-height:30px;margin-right:28px;padding:30px;font-size:14px;display:flex;justify-content:space-between;color:#f0f0f0}.overview-container .alarm-block-container .alarm-item-container:first-child{background:linear-gradient(90deg,#ff6e35,#e44402)}.overview-container .alarm-block-container .alarm-item-container.second{background:linear-gradient(90deg,#fad961,#f9ad46);color:#1c1c1c}.overview-container .alarm-block-container .alarm-item-container.third{background:linear-gradient(90deg,#3fb27e,#298b7f)}.overview-container .alarm-block-container .alarm-item-container .alarm-num{font-size:24px}.overview-container .norecovery-alarms-title{font-size:14px;color:#fff}.overview-container .module-container{width:887px;background:#2c3b40;margin-bottom:20px}.overview-container .pie-header{padding-top:20px;color:#fff;padding-left:20px;vertical-align:sub;font-size:14px}.overview-container .pie-header>span{margin-right:37px}.overview-container .pie-header .num{font-size:24px;margin-left:12px}.overview-container .pie-header .pie-abnormal-num{color:#c23531}.overview-container .overview-pie{width:884px;height:320px}",""])},2975:function(e,t,n){var r=n(2118);"string"==typeof r&&(r=[[e.id,r,""]]);n(32)(r,{});r.locals&&(e.exports=r.locals)}});